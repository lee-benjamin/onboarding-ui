<!doctype HTML>
<html>
  <head>
    <meta charset="utf-8" />
  </head>
  <body>
    <p>Hello, World!</p>
    <button type="button" onclick="getHomeTimeline()">Get Home Timeline</button>
    <div id="divTimeline">
      <p id="pTimeline"></p>

      <script>
        function appendTweet(tweet) {
            console.log(tweet);
            var tweetDiv = document.createElement("div");
            var createdAt = document.createTextNode(new Date(tweet.createdAt));
            var text = document.createTextNode(tweet.text);
            tweetDiv.appendChild(createdAt);
            tweetDiv.appendChild(text);

            var element = document.getElementById("divTimeline");
            element.appendChild(tweetDiv);
        }

        function getHomeTimeline() {
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
            if (this.readyState == XMLHttpRequest.DONE)  {
              if (this.status == 200) {
                var obj = JSON.parse(this.responseText);
                for (var i=0;i<obj.length;i++) {
                    appendTweet(obj[i]);
                }
              }
              else {
                document.getElementById("pTimeline").innerHTML = "Unable to get home timeline, please try again later.";
              }
            }
          };
          xhttp.open("GET", "http://localhost:8080/api/1.0/twitter/timeline",true);
          xhttp.send();
        }
      </script>
    </div>
  </body>
</html>
